{% extends "layout.html" %}

{% block content %}
<div class="card p-4 mx-auto" style="max-width: 800px;">
    <h3>{{ title }}</h3>
    <hr>
    <form method="post" enctype="multipart/form-data">
        <h5 class="mt-3">Dati Principali</h5>
        <div class="row g-3">
            <div class="col-md-4">
                <label for="codice_articolo" class="form-label">Codice Articolo</label>
                <input type="text" class="form-control" id="codice_articolo" name="codice_articolo" value="{{ articolo.codice_articolo if articolo else '' }}">
            </div>
            <div class="col-md-8">
                <label for="descrizione" class="form-label">Descrizione</label>
                <input type="text" class="form-control" id="descrizione" name="descrizione" value="{{ articolo.descrizione if articolo else '' }}">
            </div>
            <div class="col-md-6">
                <label for="cliente" class="form-label">Cliente</label>
                <input type="text" class="form-control" id="cliente" name="cliente" value="{{ articolo.cliente if articolo else '' }}">
            </div>
            <div class="col-md-6">
                <label for="fornitore" class="form-label">Fornitore</label>
                <input type="text" class="form-control" id="fornitore" name="fornitore" value="{{ articolo.fornitore if articolo else '' }}">
            </div>
        </div>

        <h5 class="mt-4">Dati Logistici</h5>
        <div class="row g-3">
            <div class="col-md-3"><label class="form-label">N. Colli</label><input type="number" class="form-control" name="n_colli" value="{{ articolo.n_colli if articolo else '' }}"></div>
            <div class="col-md-3"><label class="form-label">Peso (Kg)</label><input type="text" class="form-control" name="peso" value="{{ articolo.peso if articolo else '' }}"></div>
            <div class="col-md-2"><label class="form-label">Lung. (m)</label><input type="text" class="form-control" name="lunghezza" value="{{ articolo.lunghezza if articolo else '' }}"></div>
            <div class="col-md-2"><label class="form-label">Largh. (m)</label><input type="text" class="form-control" name="larghezza" value="{{ articolo.larghezza if articolo else '' }}"></div>
            <div class="col-md-2"><label class="form-label">Altezza (m)</label><input type="text" class="form-control" name="altezza" value="{{ articolo.altezza if articolo else '' }}"></div>
        </div>
        
        {% if articolo %}
        <h5 class="mt-4">Allegati</h5>
        <div class="mb-3">
            <label for="files" class="form-label">Carica nuovi allegati</label>
            <input class="form-control" type="file" id="files" name="files" multiple>
        </div>
        {% if articolo.allegati %}
        <ul class="list-group">
            {% for allegato in articolo.allegati %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="{{ url_for('uploaded_file', filename=allegato.filename) }}" target="_blank">{{ allegato.filename }}</a>
                <form action="{{ url_for('delete_attachment', id=allegato.id) }}" method="post" onsubmit="return confirm('Sei sicuro?');">
                    <button type="submit" class="btn btn-sm btn-danger">Elimina</button>
                </form>
            </li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endif %}

        <div class="mt-4">
            <button type="submit" class="btn btn-primary">Salva</button>
            <a href="{{ url_for('visualizza_giacenze') }}" class="btn btn-secondary">Annulla</a>
        </div>
    </form>
</div>
{% endblock %}
